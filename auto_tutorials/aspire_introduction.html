

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ASPIRE-Python Introduction &mdash; ASPIRE 0.14.2 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css?v=d2d258e8" />
      <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-binder.css?v=f4aeca0c" />
      <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-dataframe.css?v=2082cf3c" />
      <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-rendered-html.css?v=1277b6f3" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=0dc20415"></script>
      <script src="../_static/doctools.js?v=9a2dae69"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script type="module" src="https://cdn.jsdelivr.net/npm/mermaid@11.12.1/dist/mermaid.esm.min.mjs"></script>
      <script type="module" src="https://cdn.jsdelivr.net/npm/@mermaid-js/layout-elk@0.2.0/dist/mermaid-layout-elk.esm.min.mjs"></script>
      <script type="module">import mermaid from "https://cdn.jsdelivr.net/npm/mermaid@11.12.1/dist/mermaid.esm.min.mjs";import elkLayouts from "https://cdn.jsdelivr.net/npm/@mermaid-js/layout-elk@0.2.0/dist/mermaid-layout-elk.esm.min.mjs";mermaid.registerLayoutLoaders(elkLayouts);mermaid.initialize({startOnLoad:false});</script>
      <script src="https://cdn.jsdelivr.net/npm/d3@7.9.0/dist/d3.min.js"></script>
      <script type="module">import mermaid from "https://cdn.jsdelivr.net/npm/mermaid@11.12.1/dist/mermaid.esm.min.mjs";

const defaultStyle = document.createElement('style');
defaultStyle.textContent = `pre.mermaid {
    /* Same as .mermaid-container > pre */
    display: block;
    width: 100%;
}

pre.mermaid > svg {
    /* Same as .mermaid-container > pre > svg */
    height: 500px;
    width: 100%;
    max-width: 100% !important;
}
`;
document.head.appendChild(defaultStyle);

const fullscreenStyle = document.createElement('style');
fullscreenStyle.textContent = `.mermaid-container {
    display: flex;
    flex-direction: row;
    width: 100%;
}

.mermaid-container > pre {
    display: block;
    width: 100%;
}

.mermaid-container > pre > svg {
    height: 500px;
    width: 100%;
    max-width: 100% !important;
}

.mermaid-fullscreen-btn {
    width: 28px;
    height: 28px;
    background: rgba(255, 255, 255, 0.95);
    border: 1px solid rgba(0, 0, 0, 0.3);
    border-radius: 4px;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.2s;
    box-shadow: 0 2px 6px rgba(0, 0, 0, 0.2);
    font-size: 14px;
    line-height: 1;
    padding: 0;
    color: #333;
}

.mermaid-fullscreen-btn:hover {
    opacity: 100% !important;
    background: rgba(255, 255, 255, 1);
    box-shadow: 0 3px 10px rgba(0, 0, 0, 0.3);
    transform: scale(1.1);
}

.mermaid-fullscreen-btn.dark-theme {
    background: rgba(50, 50, 50, 0.95);
    border: 1px solid rgba(255, 255, 255, 0.3);
    color: #e0e0e0;
}

.mermaid-fullscreen-btn.dark-theme:hover {
    background: rgba(60, 60, 60, 1);
    box-shadow: 0 3px 10px rgba(255, 255, 255, 0.2);
}

.mermaid-fullscreen-modal {
    display: none;
    position: fixed !important;
    top: 0 !important;
    left: 0 !important;
    width: 95vw;
    height: 100vh;
    background: rgba(255, 255, 255, 0.98);
    z-index: 9999;
    padding: 20px;
    overflow: auto;
}

.mermaid-fullscreen-modal.dark-theme {
    background: rgba(0, 0, 0, 0.98);
}

.mermaid-fullscreen-modal.active {
    display: flex;
    align-items: center;
    justify-content: center;
}

.mermaid-container-fullscreen {
    position: relative;
    width: 95vw;
    height: 90vh;
    max-width: 95vw;
    max-height: 90vh;
    background: white;
    border-radius: 8px;
    padding: 20px;
    box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
    overflow: auto;
    display: flex;
    align-items: center;
    justify-content: center;
}

.mermaid-container-fullscreen.dark-theme {
    background: #1a1a1a;
    box-shadow: 0 10px 40px rgba(0, 0, 0, 0.8);
}

.mermaid-container-fullscreen pre.mermaid {
    width: 100%;
    height: 100%;
    display: flex;
    align-items: center;
    justify-content: center;
}

.mermaid-container-fullscreen .mermaid svg {
    height: 100% !important;
    width: 100% !important;
    cursor: grab;
}

.mermaid-fullscreen-close {
    position: fixed !important;
    top: 20px !important;
    right: 20px !important;
    width: 40px;
    height: 40px;
    background: rgba(255, 255, 255, 0.95);
    border: 1px solid rgba(0, 0, 0, 0.2);
    border-radius: 50%;
    cursor: pointer;
    z-index: 10000;
    display: flex;
    align-items: center;
    justify-content: center;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
    transition: all 0.2s;
    font-size: 24px;
    line-height: 1;
    color: #333;
}

.mermaid-fullscreen-close:hover {
    background: white;
    box-shadow: 0 6px 16px rgba(0, 0, 0, 0.4);
    transform: scale(1.1);
}

.mermaid-fullscreen-close.dark-theme {
    background: rgba(50, 50, 50, 0.95);
    border: 1px solid rgba(255, 255, 255, 0.2);
    color: #e0e0e0;
}

.mermaid-fullscreen-close.dark-theme:hover {
    background: rgba(60, 60, 60, 1);
    box-shadow: 0 6px 16px rgba(255, 255, 255, 0.2);
}

.mermaid-fullscreen-modal .mermaid-fullscreen-btn {
    display: none !important;
}`;
document.head.appendChild(fullscreenStyle);

// Detect if page has dark background
const isDarkTheme = () => {
    const bgColor = window.getComputedStyle(document.body).backgroundColor;
    const match = bgColor.match(/rgb\((\d+),\s*(\d+),\s*(\d+)/);
    if (match) {
        const r = parseInt(match[1]);
        const g = parseInt(match[2]);
        const b = parseInt(match[3]);
        const brightness = (r * 299 + g * 587 + b * 114) / 1000;
        return brightness < 128;
    }
    return false;
};

const load = async () => {
    await mermaid.run();

    const all_mermaids = document.querySelectorAll(".mermaid");
    const mermaids_processed = document.querySelectorAll(".mermaid[data-processed='true']");

    if ("False" === "True") {
        const mermaids_to_add_zoom = -1 === -1 ? all_mermaids.length : -1;
        if(mermaids_to_add_zoom > 0) {
            var svgs = d3.selectAll("");
            if(all_mermaids.length !== mermaids_processed.length) {
                setTimeout(load, 200);
                return;
            } else if(svgs.size() !== mermaids_to_add_zoom) {
                setTimeout(load, 200);
                return;
            } else {
                svgs.each(function() {
                    var svg = d3.select(this);
                    svg.html("<g class='wrapper'>" + svg.html() + "</g>");
                    var inner = svg.select("g");
                    var zoom = d3.zoom().on("zoom", function(event) {
                        inner.attr("transform", event.transform);
                    });
                    svg.call(zoom);
                });
            }
        }
    } else if(all_mermaids.length !== mermaids_processed.length) {
        // Wait for mermaid to process all diagrams
        setTimeout(load, 200);
        return;
    }

    const darkTheme = isDarkTheme();

    // Stop here if not adding fullscreen capability
    if ("True" !== "True") return;

    const modal = document.createElement('div');
    modal.className = 'mermaid-fullscreen-modal' + (darkTheme ? ' dark-theme' : '');
    modal.setAttribute('role', 'dialog');
    modal.setAttribute('aria-modal', 'true');
    modal.setAttribute('aria-label', 'Fullscreen diagram viewer');
    modal.innerHTML = `
        <button class="mermaid-fullscreen-close${darkTheme ? ' dark-theme' : ''}" aria-label="Close fullscreen">✕</button>
        <div class="mermaid-container-fullscreen${darkTheme ? ' dark-theme' : ''}"></div>
    `;
    document.body.appendChild(modal);

    const modalContent = modal.querySelector('.mermaid-container-fullscreen');
    const closeBtn = modal.querySelector('.mermaid-fullscreen-close');

    let previousScrollOffset = [window.scrollX, window.scrollY];

    const closeModal = () => {
        modal.classList.remove('active');
        modalContent.innerHTML = '';
        document.body.style.overflow = ''
        window.scrollTo({left: previousScrollOffset[0], top: previousScrollOffset[1], behavior: 'instant'});
    };

    closeBtn.addEventListener('click', closeModal);
    modal.addEventListener('click', (e) => {
        if (e.target === modal) closeModal();
    });
    document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape' && modal.classList.contains('active')) {
            closeModal();
        }
    });

    const allButtons = [];

    document.querySelectorAll('.mermaid').forEach((mermaidDiv) => {
        if (mermaidDiv.parentNode.classList.contains('mermaid-container') ||
            mermaidDiv.closest('.mermaid-fullscreen-modal')) {
            return;
        }

        const container = document.createElement('div');
        container.className = 'mermaid-container';
        mermaidDiv.parentNode.insertBefore(container, mermaidDiv);
        container.appendChild(mermaidDiv);

        const fullscreenBtn = document.createElement('button');
        fullscreenBtn.className = 'mermaid-fullscreen-btn' + (darkTheme ? ' dark-theme' : '');
        fullscreenBtn.setAttribute('aria-label', 'View diagram in fullscreen');
        fullscreenBtn.textContent = '⛶';
        fullscreenBtn.style.opacity = '50%';

        // Calculate dynamic position based on diagram's margin and padding
        const diagramStyle = window.getComputedStyle(mermaidDiv);
        const marginTop = parseFloat(diagramStyle.marginTop) || 0;
        const marginRight = parseFloat(diagramStyle.marginRight) || 0;
        const paddingTop = parseFloat(diagramStyle.paddingTop) || 0;
        const paddingRight = parseFloat(diagramStyle.paddingRight) || 0;
        fullscreenBtn.style.top = `${marginTop + paddingTop + 4}px`;
        fullscreenBtn.style.right = `${marginRight + paddingRight + 4}px`;

        fullscreenBtn.addEventListener('click', () => {
            previousScrollOffset = [window.scroll, window.scrollY];
            const clone = mermaidDiv.cloneNode(true);
            modalContent.innerHTML = '';
            modalContent.appendChild(clone);

            const svg = clone.querySelector('svg');
            if (svg) {
                svg.removeAttribute('width');
                svg.removeAttribute('height');
                svg.style.width = '100%';
                svg.style.height = 'auto';
                svg.style.maxWidth = '100%';
                svg.style.sdisplay = 'block';

                if ("False" === "True") {
                    setTimeout(() => {
                        const g = svg.querySelector('g');
                        if (g) {
                            var svgD3 = d3.select(svg);
                            svgD3.html("<g class='wrapper'>" + svgD3.html() + "</g>");
                            var inner = svgD3.select("g");
                            var zoom = d3.zoom().on("zoom", function(event) {
                                inner.attr("transform", event.transform);
                            });
                            svgD3.call(zoom);
                        }
                    }, 100);
                }
            }

            modal.classList.add('active');
            document.body.style.overflow = 'hidden';
        });

        container.appendChild(fullscreenBtn);
        allButtons.push(fullscreenBtn);
    });

    // Update theme classes when theme changes
    const updateTheme = () => {
        const dark = isDarkTheme();
        allButtons.forEach(btn => {
            if (dark) {
                btn.classList.add('dark-theme');
            } else {
                btn.classList.remove('dark-theme');
            }
        });
        if (dark) {
            modal.classList.add('dark-theme');
            modalContent.classList.add('dark-theme');
            closeBtn.classList.add('dark-theme');
        } else {
            modal.classList.remove('dark-theme');
            modalContent.classList.remove('dark-theme');
            closeBtn.classList.remove('dark-theme');
        }
    };

    // Watch for theme changes
    const observer = new MutationObserver(updateTheme);
    observer.observe(document.documentElement, {
        attributes: true,
        attributeFilter: ['class', 'style', 'data-theme']
    });
    observer.observe(document.body, {
        attributes: true,
        attributeFilter: ['class', 'style']
    });
};

window.addEventListener("load", load);
</script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Ab-initio Pipeline Demonstration" href="pipeline_demo.html" />
    <link rel="prev" title="ASPIRE Configuration" href="configuration.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            ASPIRE
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quickstart.html">Getting Started - CLI</a></li>
<li class="toctree-l1"><a class="reference internal" href="../class_source.html">Class Averaging Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modules.html">Modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../authors.html">Authors</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Galleries:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Tutorials</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="index.html#api-introduction">API Introduction</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="configuration.html">ASPIRE Configuration</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">ASPIRE-Python Introduction</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#installation">Installation</a></li>
<li class="toctree-l4"><a class="reference internal" href="#api-primitives">API Primitives</a></li>
<li class="toctree-l4"><a class="reference internal" href="#image-class"><code class="docutils literal notranslate"><span class="pre">Image</span></code> Class</a></li>
<li class="toctree-l4"><a class="reference internal" href="#volume-class"><code class="docutils literal notranslate"><span class="pre">Volume</span></code> Class</a></li>
<li class="toctree-l4"><a class="reference internal" href="#rotation-class"><code class="docutils literal notranslate"><span class="pre">Rotation</span></code> Class</a></li>
<li class="toctree-l4"><a class="reference internal" href="#the-filter-package">The <code class="docutils literal notranslate"><span class="pre">filter</span></code> Package</a></li>
<li class="toctree-l4"><a class="reference internal" href="#basis"><code class="docutils literal notranslate"><span class="pre">Basis</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#the-source-package">The <code class="docutils literal notranslate"><span class="pre">source</span></code> Package</a></li>
<li class="toctree-l4"><a class="reference internal" href="#the-noise-package">The <code class="docutils literal notranslate"><span class="pre">noise</span></code> Package</a></li>
<li class="toctree-l4"><a class="reference internal" href="#common-image-corruptions">Common Image Corruptions</a></li>
<li class="toctree-l4"><a class="reference internal" href="#real-experimental-data-relionsource">Real Experimental Data - <code class="docutils literal notranslate"><span class="pre">RelionSource</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pipeline-roadmap">Pipeline Roadmap</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="pipeline_demo.html">Ab-initio Pipeline Demonstration</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="index.html#component-examples">Component Examples</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../auto_experiments/index.html">Experiments</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">ASPIRE</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">Tutorials</a></li>
      <li class="breadcrumb-item active">ASPIRE-Python Introduction</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/auto_tutorials/aspire_introduction.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#sphx-glr-download-auto-tutorials-aspire-introduction-py"><span class="std std-ref">Go to the end</span></a>
to download the full example code.</p>
</div>
<section class="sphx-glr-example-title" id="aspire-python-introduction">
<span id="sphx-glr-auto-tutorials-aspire-introduction-py"></span><h1>ASPIRE-Python Introduction<a class="headerlink" href="#aspire-python-introduction" title="Link to this heading">¶</a></h1>
<p>In this notebook we will introduce the core API components, then
demonstrate basic usage corresponding to topics from Princeton’s
MAT586.</p>
<section id="installation">
<h2>Installation<a class="headerlink" href="#installation" title="Link to this heading">¶</a></h2>
<p>ASPIRE can generally install on Linux, Mac, and Windows under
Anaconda Python, by following the instructions in the README.  <a class="reference external" href="https://github.com/ComputationalCryoEM/ASPIRE-Python/blob/main/README.md#for-developers">The
instructions for developers is the most comprehensive</a>.
Windows is provided, but generally Linux and MacOS are recommended,
with Linux being the most diversely tested platform.</p>
<section id="princeton-research-computing">
<h3>Princeton Research Computing<a class="headerlink" href="#princeton-research-computing" title="Link to this heading">¶</a></h3>
<p>ASPIRE requires some resources to run, so if you wouldn’t run
typical data science codes on your machine (a netbook for example),
you may use Tiger/Adroit/Della at Princeton or another cluster.
After logging into Tiger, <code class="docutils literal notranslate"><span class="pre">module</span> <span class="pre">load</span> <span class="pre">anaconda3/2020.7</span></code> and
continue to follow the Anaconda instructions for developers in the
link above.  Those instructions should create a working environment
for tinkering with ASPIRE code found in this notebook.</p>
</section>
<section id="imports">
<h3>Imports<a class="headerlink" href="#imports" title="Link to this heading">¶</a></h3>
<p>First we import some typical scientific computing packages.
Along the way we will import relevant components from <code class="docutils literal notranslate"><span class="pre">aspire</span></code>.
Users may also import <code class="docutils literal notranslate"><span class="pre">aspire</span></code> once as a top level package.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">os</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">aspire</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">aspire.image</span><span class="w"> </span><span class="kn">import</span> <span class="n">Image</span>
</pre></div>
</div>
</section>
</section>
<section id="api-primitives">
<h2>API Primitives<a class="headerlink" href="#api-primitives" title="Link to this heading">¶</a></h2>
<p>The ASPIRE framework is a collection of modules containing
interoperable extensible components.  Underlying the more
sophisticated components and algorithms are some core data
structures.  Sophisticated components are designed to interoperate
by exchanging, consuming, or producing these basic structures.  The
most common structures encountered when starting out are:</p>
<table class="docutils align-default" id="id3">
<caption><span class="caption-text">Core API Components</span><a class="headerlink" href="#id3" title="Link to this table">¶</a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>Component</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">Coef</span></code></p></td>
<td><p>Utility class for stacks of 1D arrays.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">Image</span></code></p></td>
<td><p>Utility class for stacks of 2D arrays.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">Volume</span></code></p></td>
<td><p>Utility class for stacks of 3D arrays.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">Rotations</span></code></p></td>
<td><p>Utility class for stacks of 3D rotations.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">Filter</span></code></p></td>
<td><p>Constructs and applies Image filters.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">Basis</span></code></p></td>
<td><p>Basis conversions and operations.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">Source</span></code></p></td>
<td><p>Produces primitive components. <code class="docutils literal notranslate"><span class="pre">ImageSource</span></code> produces <code class="docutils literal notranslate"><span class="pre">Image</span></code> instances.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="image-class">
<h2><code class="docutils literal notranslate"><span class="pre">Image</span></code> Class<a class="headerlink" href="#image-class" title="Link to this heading">¶</a></h2>
<p>The <a class="reference external" href="https://computationalcryoem.github.io/ASPIRE-Python/aspire.image.html#aspire.image.image.Image">Image</a>
class is a thin wrapper over Numpy arrays for a stack containing 1
or more images (2D data).  In this notebook we won’t be working
directly with the <code class="docutils literal notranslate"><span class="pre">Image</span></code> class a lot, but it will be one of the
fundamental structures behind the scenes.  A lot of ASPIRE code
passes around <code class="docutils literal notranslate"><span class="pre">Image</span></code> and <code class="docutils literal notranslate"><span class="pre">Volume</span></code> instances.</p>
<p>Create an <code class="docutils literal notranslate"><span class="pre">Image</span></code> instance from random data.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">img_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">))</span>
<span class="n">img</span> <span class="o">=</span> <span class="n">Image</span><span class="p">(</span><span class="n">img_data</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;img shape: </span><span class="si">{</span><span class="n">img</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>  <span class="c1"># Note this produces a stack of one.</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;str(img): </span><span class="si">{</span><span class="n">img</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>img shape: (1, 100, 100)
str(img): 1 float64 images arranged as a (1,) stack each of size 100x100.
</pre></div>
</div>
<p>Create an Image for a stack of 3 100x100 images.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">img_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">))</span>
<span class="n">img</span> <span class="o">=</span> <span class="n">Image</span><span class="p">(</span><span class="n">img_data</span><span class="p">)</span>
</pre></div>
</div>
<p>Most often, Images will behave like Numpy arrays, but you
explicitly access the underlying Numpy array via <code class="docutils literal notranslate"><span class="pre">asnumpy()</span></code>.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">img</span><span class="o">.</span><span class="n">asnumpy</span><span class="p">()</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>array([[[0.18978222, 0.03597445, 0.42684394, ..., 0.57499242,
         0.50035142, 0.93248888],
        [0.48136043, 0.71114283, 0.94876505, ..., 0.3857256 ,
         0.5133734 , 0.37308436],
        [0.41827013, 0.24328257, 0.32153883, ..., 0.14442709,
         0.81864006, 0.1826004 ],
        ...,
        [0.02096099, 0.71048841, 0.10933703, ..., 0.14278004,
         0.15326041, 0.11644226],
        [0.38402795, 0.15749828, 0.1224955 , ..., 0.58674996,
         0.38246113, 0.18810879],
        [0.48076162, 0.87760989, 0.07928011, ..., 0.73745473,
         0.20171207, 0.14966498]],

       [[0.59637902, 0.03908459, 0.0630965 , ..., 0.34202068,
         0.17187473, 0.12696227],
        [0.28832948, 0.73949463, 0.1363744 , ..., 0.86097116,
         0.18507553, 0.38326218],
        [0.11673635, 0.12096465, 0.67883063, ..., 0.11066638,
         0.30816852, 0.56932504],
        ...,
        [0.65440824, 0.0918645 , 0.32679724, ..., 0.62093809,
         0.84331534, 0.15711554],
        [0.96365969, 0.95460403, 0.11109738, ..., 0.14853662,
         0.07707954, 0.45949033],
        [0.39281602, 0.81049032, 0.39840345, ..., 0.03555752,
         0.27311408, 0.73863686]],

       [[0.77900378, 0.59317897, 0.39457934, ..., 0.84146627,
         0.56604113, 0.00429202],
        [0.63930838, 0.46397302, 0.93632383, ..., 0.93045546,
         0.45619192, 0.73640916],
        [0.06360715, 0.20704065, 0.13326346, ..., 0.77327489,
         0.70631134, 0.06716387],
        ...,
        [0.48594023, 0.02945904, 0.42337816, ..., 0.85025812,
         0.14962363, 0.65405444],
        [0.65885265, 0.32474352, 0.90077042, ..., 0.54721393,
         0.77289876, 0.81111946],
        [0.47259429, 0.76788603, 0.30561345, ..., 0.41443081,
         0.80065979, 0.12476999]]])
</pre></div>
</div>
<p>Images have a built in <code class="docutils literal notranslate"><span class="pre">show()</span></code> method, which works well for
peeking at data.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">img</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_aspire_introduction_001.png" srcset="../_images/sphx_glr_aspire_introduction_001.png" alt="aspire introduction" class = "sphx-glr-single-img"/><div class="admonition note">
<p class="admonition-title">Note</p>
<p>The user is responsible for using <code class="docutils literal notranslate"><span class="pre">show</span></code> responsibly.  Avoid
asking for large numbers of images that you would not normally
plot.  Ten or less is reasonable.</p>
</div>
<p>More examples using the Image class can be found in:</p>
<ul class="simple">
<li><p><a class="reference internal" href="tutorials/image_class.html#sphx-glr-auto-tutorials-tutorials-image-class-py"><span class="std std-ref">ASPIRE Image Class</span></a></p></li>
<li><p><a class="reference internal" href="tutorials/basic_image_array.html#sphx-glr-auto-tutorials-tutorials-basic-image-array-py"><span class="std std-ref">Basic Image Array</span></a></p></li>
</ul>
</section>
<section id="volume-class">
<h2><code class="docutils literal notranslate"><span class="pre">Volume</span></code> Class<a class="headerlink" href="#volume-class" title="Link to this heading">¶</a></h2>
<p>Like <code class="docutils literal notranslate"><span class="pre">Image</span></code>, the <a class="reference external" href="https://computationalcryoem.github.io/ASPIRE-Python/aspire.volume.html#aspire.volume.Volume">Volume</a>
class is a thin wrapper over Numpy arrays that provides specialized
methods for a stack containing one or more volumes (3D data).</p>
<section id="initialize-volume-load">
<h3>Initialize Volume - <code class="docutils literal notranslate"><span class="pre">load</span></code><a class="headerlink" href="#initialize-volume-load" title="Link to this heading">¶</a></h3>
<p>A <code class="docutils literal notranslate"><span class="pre">Volume</span></code> may be instantiated with Numpy data similarly to
<code class="docutils literal notranslate"><span class="pre">Image</span></code>.  Both <code class="docutils literal notranslate"><span class="pre">Image</span></code> and <code class="docutils literal notranslate"><span class="pre">Volume</span></code> provide <code class="docutils literal notranslate"><span class="pre">save</span></code> and
<code class="docutils literal notranslate"><span class="pre">load</span></code> methods which can be used to work with files.  For
<code class="docutils literal notranslate"><span class="pre">Volumes</span></code> <code class="docutils literal notranslate"><span class="pre">.map</span></code> and <code class="docutils literal notranslate"><span class="pre">.mrc</span></code> are currently supported.  For
<code class="docutils literal notranslate"><span class="pre">.npy</span></code>, Numpy can be used.</p>
<p>For example, in the following note we demonstrate instantiating an ASPIRE Volume
instance using <code class="docutils literal notranslate"><span class="pre">Volume.load()</span></code>:</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Instantiate an ASPIRE Volume from file:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">aspire.volume</span><span class="w"> </span><span class="kn">import</span> <span class="n">Volume</span>

<span class="n">aspire_volume</span> <span class="o">=</span> <span class="n">Volume</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;/path/to/volume.mrc&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>In addition to the <code class="docutils literal notranslate"><span class="pre">Volume.load()</span></code> method, a few common
starting datasets can be downloaded from EMDB using ASPIRE’s downloading
utility. Below we download the high resolution volume map EMDB-2660, sourced from
<a class="reference external" href="https://www.ebi.ac.uk/pdbe/entry/emdb/EMD-2660">https://www.ebi.ac.uk/pdbe/entry/emdb/EMD-2660</a>.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">aspire.downloader</span><span class="w"> </span><span class="kn">import</span> <span class="n">emdb_2660</span>

<span class="n">vol</span> <span class="o">=</span> <span class="n">emdb_2660</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="downsample-volume">
<h3>Downsample Volume<a class="headerlink" href="#downsample-volume" title="Link to this heading">¶</a></h3>
<p>Here we downsample the above volume to a desired image size (64
should be good).</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">img_size</span> <span class="o">=</span> <span class="mi">64</span>

<span class="c1"># Volume.downsample() returns a new Volume instance.</span>
<span class="c1">#   We will use this lower resolution volume later, calling it `v2`.</span>
<span class="n">vol_ds</span> <span class="o">=</span> <span class="n">vol</span><span class="o">.</span><span class="n">downsample</span><span class="p">(</span><span class="n">img_size</span><span class="p">)</span>
<span class="c1"># L is often used as short hand for image and volume sizes (in pixels/voxels).</span>
<span class="n">L</span> <span class="o">=</span> <span class="n">vol_ds</span><span class="o">.</span><span class="n">resolution</span>
</pre></div>
</div>
<section id="plot-data">
<h4>Plot Data<a class="headerlink" href="#plot-data" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>For quick sanity checking purposes we can view some plots.</dt><dd><p>We’ll use three orthographic projections, one per axis.</p>
</dd>
</dl>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">orthographic_projections</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">L</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">vol_ds</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
    <span class="n">orthographic_projections</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">vol_ds</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">Image</span><span class="p">(</span><span class="n">orthographic_projections</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_aspire_introduction_002.png" srcset="../_images/sphx_glr_aspire_introduction_002.png" alt="aspire introduction" class = "sphx-glr-single-img"/></section>
</section>
</section>
<section id="rotation-class">
<h2><code class="docutils literal notranslate"><span class="pre">Rotation</span></code> Class<a class="headerlink" href="#rotation-class" title="Link to this heading">¶</a></h2>
<p>While you may bring your own 3x3 matrices or generate manually (say
from your own Euler angles), ASPIRE has a <a class="reference external" href="https://computationalcryoem.github.io/ASPIRE-Python/aspire.utils.html#module-aspire.utils.rotation">Rotation class</a>
which can do this random rotation generation for us.  It also has
some other utility methods, including support for Rodrigues
rotations (ie, axis-angle).  Other ASPIRE components dealing with 3D
rotations will generally expect instances of <code class="docutils literal notranslate"><span class="pre">Rotation</span></code>.</p>
<p>A common task in computational cryo-EM is generating random
projections, by applying random 3D rotations to a volume and projecting along the z-axis.
The following code will generate some random rotations,
and use the <code class="docutils literal notranslate"><span class="pre">Volume.project()</span></code> method to return an <code class="docutils literal notranslate"><span class="pre">Image</span></code>
instance representing the stack of projections.  We can display
projection images using the <code class="docutils literal notranslate"><span class="pre">Image.show()</span></code> method.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">aspire.utils</span><span class="w"> </span><span class="kn">import</span> <span class="n">Rotation</span>

<span class="n">num_rotations</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">rots</span> <span class="o">=</span> <span class="n">Rotation</span><span class="o">.</span><span class="n">generate_random_rotations</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">num_rotations</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">12345</span><span class="p">)</span>
</pre></div>
</div>
<p>We can access the Numpy array holding the actual stack of 3x3 matrices:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">rots</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">rots</span><span class="o">.</span><span class="n">matrices</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Rotation stack consisting of 2 elements of float32 type
[[[ 0.34373102 -0.62564886  0.7002946 ]
  [-0.61950386 -0.7115173  -0.33159938]
  [ 0.70573646 -0.3198542  -0.63216245]]

 [[ 0.3189953   0.88963485 -0.3267902 ]
  [ 0.67460066  0.02905637  0.7376108 ]
  [ 0.6656996  -0.45574725 -0.5908794 ]]]
</pre></div>
</div>
<p>Using the <code class="docutils literal notranslate"><span class="pre">Volume.project()</span></code> method we compute
projections using the stack of rotations:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">projections</span> <span class="o">=</span> <span class="n">vol</span><span class="o">.</span><span class="n">project</span><span class="p">(</span><span class="n">rots</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">projections</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>2 float32 images arranged as a (2,) stack each of size 360x360 with pixel_size=1.340000033378601 angstroms.
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">project()</span></code> returns an Image instance, so we can call <code class="docutils literal notranslate"><span class="pre">show</span></code>.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">projections</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_aspire_introduction_003.png" srcset="../_images/sphx_glr_aspire_introduction_003.png" alt="aspire introduction" class = "sphx-glr-single-img"/><p>Neat, we’ve generated random projections of some real data.  This
tutorial will go on to show how this can be performed systematically with
other cryo-EM data simulation tasks.</p>
</section>
<section id="the-filter-package">
<h2>The <code class="docutils literal notranslate"><span class="pre">filter</span></code> Package<a class="headerlink" href="#the-filter-package" title="Link to this heading">¶</a></h2>
<p><a class="reference external" href="https://computationalcryoem.github.io/ASPIRE-Python/aspire.operators.html#module-aspire.operators.filters">Filters</a>
are a collection of classes which once configured can be applied to
<code class="docutils literal notranslate"><span class="pre">Images</span></code>, typically in an <code class="docutils literal notranslate"><span class="pre">ImageSource</span></code> pipeline which will be
discussed in a later section.  Specifically, applying a <code class="docutils literal notranslate"><span class="pre">Filter</span></code>
convolves the filter with the images contained in the <code class="docutils literal notranslate"><span class="pre">Image</span></code>
instance.</p>
<pre  class="mermaid">
        classDiagram
    class Filter{
        +evaluate()
        +basis_mat()
        +scale()
        +evaluate_grid()
        +dual()
        +sign()
     }

     Filter o-- FunctionFilter
     Filter o-- ArrayFilter
     Filter o-- ScalarFilter
     Filter o-- ZeroFilter
     Filter o-- IdentityFilter
     Filter o-- CTFFilter
     CTFFilter o-- RadialCTFFilter
    </pre><p><code class="docutils literal notranslate"><span class="pre">CTFFilter</span></code> and <code class="docutils literal notranslate"><span class="pre">RadialCTFFilter</span></code> are the most common filters
encountered when starting out and are detailed in
<a class="reference internal" href="tutorials/ctf.html#sphx-glr-auto-tutorials-tutorials-ctf-py"><span class="std std-ref">CTF: Contrast Transfer Function</span></a>.  The other filters
are used behind the scenes in components like <code class="docutils literal notranslate"><span class="pre">NoiseAdders</span></code> or
more advanced customized pipelines.  Several filters for internal or
advanced use cases are omitted from the diagram, but can be found in
the <cite>aspire.operators.filter</cite> module.</p>
</section>
<section id="basis">
<h2><code class="docutils literal notranslate"><span class="pre">Basis</span></code><a class="headerlink" href="#basis" title="Link to this heading">¶</a></h2>
<p>ASPIRE provides a selection of <code class="docutils literal notranslate"><span class="pre">Basis</span></code> classes designed for
working with cryo-EM data in two and three dimensions.  Most of
these basis implementations are optimized for efficient rotations,
often called the <em>“steerable”</em> property.  As of this writing most
algorithms in ASPIRE are written to work well with the fast
Fourier-Bessel (FFB) basis classes <code class="docutils literal notranslate"><span class="pre">FFBBasis2D</span></code> and
<code class="docutils literal notranslate"><span class="pre">FFBBasis3D</span></code>.  These correspond to direct slower reference
<code class="docutils literal notranslate"><span class="pre">FBBasis2D</span></code> and <code class="docutils literal notranslate"><span class="pre">FBBasis3D</span></code> classes.</p>
<p>Recently, a related Fourier-Bessel method using fast Laplacian
eigenfunction (FLE) transforms was integrated as <code class="docutils literal notranslate"><span class="pre">FLEBasis2D</span></code>.
Additional prolate spheroidal wave function (PSWF) methods are
available via <code class="docutils literal notranslate"><span class="pre">FPSWFBasis2D</span></code> and <code class="docutils literal notranslate"><span class="pre">FPSWFBasis3D</span></code>, but their
integration into other components like 2D covariance analysis is
incomplete, and slated for a future release.</p>
</section>
<section id="the-source-package">
<h2>The <code class="docutils literal notranslate"><span class="pre">source</span></code> Package<a class="headerlink" href="#the-source-package" title="Link to this heading">¶</a></h2>
<p>The <a class="reference external" href="https://computationalcryoem.github.io/ASPIRE-Python/aspire.source.html#module-aspire.source.simulation">aspire.source</a>
package contains a collection of data source interfaces.
Ostensibly, a <code class="docutils literal notranslate"><span class="pre">Source</span></code> is a producer of some primitive type, most
notably <code class="docutils literal notranslate"><span class="pre">Image</span></code>.  ASPIRE components that consume (process) images
are designed to accept an <code class="docutils literal notranslate"><span class="pre">ImageSource</span></code>.</p>
<p>The first reason for this is to normalize the way a wide variety of
higher-level components interface.  <code class="docutils literal notranslate"><span class="pre">ImageSource</span></code> instances have a
consistent property <code class="docutils literal notranslate"><span class="pre">images</span></code> which must be implemented to serve up
images dynamically using a square-bracket <code class="docutils literal notranslate"><span class="pre">[]</span></code> syntax familiar to
Numpy users. This supports batch computation among other things.
<code class="docutils literal notranslate"><span class="pre">Source</span></code> instances also store and serve up metadata like
<cite>rotations</cite>, <cite>dtype</cite>, and support pipelining transformations.</p>
<p>The second reason is so we can design an experiment using a
synthetic <code class="docutils literal notranslate"><span class="pre">Simulation</span></code> source or our own provided Numpy arrays via
<code class="docutils literal notranslate"><span class="pre">ArrayImageSource</span></code> and then later swap out the source for a large
experimental data set using something like <code class="docutils literal notranslate"><span class="pre">RelionSource</span></code>.
Experimental datasets can be too large to practically fit or process
entirely in memory, and force the use of iteratively-batched
approaches.</p>
<p>Generally, the <code class="docutils literal notranslate"><span class="pre">source</span></code> package attempts to make most of this
opaque to an end user.  Ideally we can simply swap one source for
another.  For now we will build up to the creation and application
of synthetic data set based on the various manual interactions
above.</p>
<pre  class="mermaid">
        classDiagram
    class ImageSource{
        +L
        +n
        +dtype
        ...
        +images[]
        +cache()
        +downsample()
        +whiten()
        +phase_flip()
        +invert_conrast()
        +normalize_background()
        +save()
        +save_images()
        ...
        }
    ImageSource o-- ArrayImageSource
    ImageSource o-- Simulation
    ImageSource o-- RelionSource
    ImageSource o-- CoordinateSource
    CoordinateSource o-- BoxesCoordinateSource
    CoordinateSource o-- CentersCoordinateSource
    </pre><section id="simulation-class">
<h3><code class="docutils literal notranslate"><span class="pre">Simulation</span></code> Class<a class="headerlink" href="#simulation-class" title="Link to this heading">¶</a></h3>
<p>Generating realistic synthetic data sources is a common task.  The
process of generating then projecting random rotations is integrated
into the <a class="reference external" href="https://computationalcryoem.github.io/ASPIRE-Python/aspire.source.html#module-aspire.source.simulation">Simulation</a>
class.  Using <code class="docutils literal notranslate"><span class="pre">Simulation</span></code>, we can generate arbitrary numbers of
projections for use in experiments.  Then additional features are
introduced which allow us to create more realistic data sources.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">aspire.source</span><span class="w"> </span><span class="kn">import</span> <span class="n">Simulation</span>

<span class="c1"># Total images in our source.</span>
<span class="n">num_imgs</span> <span class="o">=</span> <span class="mi">100</span>
</pre></div>
</div>
<p>Generate a Simulation instance based on the original volume data.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">sim</span> <span class="o">=</span> <span class="n">Simulation</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">num_imgs</span><span class="p">,</span> <span class="n">vols</span><span class="o">=</span><span class="n">vol</span><span class="p">)</span>
<span class="c1"># Display the first 10 images</span>
<span class="n">sim</span><span class="o">.</span><span class="n">images</span><span class="p">[:</span><span class="mi">10</span><span class="p">]</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>  <span class="c1"># Hi Res</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_aspire_introduction_004.png" srcset="../_images/sphx_glr_aspire_introduction_004.png" alt="aspire introduction" class = "sphx-glr-single-img"/><p>Repeat for the lower resolution (downsampled) volume vol_ds.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">sim</span> <span class="o">=</span> <span class="n">Simulation</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">num_imgs</span><span class="p">,</span> <span class="n">vols</span><span class="o">=</span><span class="n">vol_ds</span><span class="p">)</span>
<span class="n">sim</span><span class="o">.</span><span class="n">images</span><span class="p">[:</span><span class="mi">10</span><span class="p">]</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>  <span class="c1"># Lo Res</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_aspire_introduction_005.png" srcset="../_images/sphx_glr_aspire_introduction_005.png" alt="aspire introduction" class = "sphx-glr-single-img"/><p>Note both of those simulations have the same rotations because they
had the same seed by default, We recreate <code class="docutils literal notranslate"><span class="pre">sim</span></code> with a distinct
seed to get different random samples (of rotations).</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">sim</span> <span class="o">=</span> <span class="n">Simulation</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">num_imgs</span><span class="p">,</span> <span class="n">vols</span><span class="o">=</span><span class="n">vol_ds</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="n">sim</span><span class="o">.</span><span class="n">images</span><span class="p">[:</span><span class="mi">10</span><span class="p">]</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_aspire_introduction_006.png" srcset="../_images/sphx_glr_aspire_introduction_006.png" alt="aspire introduction" class = "sphx-glr-single-img"/><p>We can also view the rotations used to create these projections.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">sim</span><span class="o">.</span><span class="n">rotations</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>[[[ 0.13749325  0.9594606  -0.24603027]
  [ 0.9659938  -0.07497535  0.24745627]
  [ 0.21897835 -0.2716873  -0.93714166]]

 [[ 0.37807834  0.13208102  0.9163031 ]
  [ 0.40860063  0.8643426  -0.29318497]
  [-0.83072394  0.48524892  0.27282083]]

 [[ 0.86643094  0.48816934 -0.10482426]
  [ 0.0985426  -0.37300438 -0.92258173]
  [-0.48947603  0.7890237  -0.37128803]]

 [[-0.35693908  0.4585702  -0.813823  ]
  [ 0.4763827  -0.66004634 -0.58086   ]
  [-0.803526   -0.5950228   0.01714141]]

 [[ 0.1588924   0.93312883  0.32252717]
  [-0.87645537 -0.01707335  0.48118034]
  [ 0.45450985 -0.35913655  0.8151329 ]]

 [[-0.326744   -0.8130629   0.48183718]
  [-0.38360518  0.58002734  0.7186204 ]
  [-0.8637624   0.04996967 -0.5014156 ]]

 [[-0.34698084 -0.1871273   0.9190145 ]
  [ 0.5046363   0.78870445  0.35112315]
  [-0.79053557  0.5856011  -0.1792341 ]]

 [[-0.8140751  -0.093647    0.57315964]
  [-0.37379515 -0.6708314  -0.64051735]
  [ 0.44447598 -0.7356735   0.5111023 ]]

 [[ 0.45521852  0.5792567  -0.67619354]
  [ 0.29612735 -0.81470734 -0.49855852]
  [-0.83969325  0.02671365 -0.54240364]]

 [[ 0.93491715  0.32658467 -0.13882488]
  [ 0.21361436 -0.8303164  -0.5147267 ]
  [-0.28337044  0.45157185 -0.84604025]]

 [[ 0.43646738 -0.00271974  0.89971596]
  [-0.24721193 -0.9618694   0.11701906]
  [ 0.865091   -0.27349553 -0.420497  ]]

 [[ 0.06204437 -0.68872344  0.7223645 ]
  [-0.9629127  -0.23171902 -0.13822247]
  [ 0.26258266 -0.686998   -0.6775574 ]]

 [[-0.9549782  -0.1546597   0.25317377]
  [ 0.0272563  -0.8954967  -0.44423273]
  [ 0.29542118 -0.41733202  0.8593953 ]]

 [[-0.9362025  -0.29906207  0.1846258 ]
  [ 0.32780164 -0.553521    0.7656113 ]
  [-0.12677105  0.77728784  0.6162408 ]]

 [[ 0.8579973   0.32184705  0.40031877]
  [-0.46083617  0.13809925  0.8766748 ]
  [ 0.22687146 -0.93666595  0.26680756]]

 [[-0.88663757 -0.37402767  0.27198744]
  [ 0.45935175 -0.64413124  0.6116297 ]
  [-0.05357084  0.6672318   0.7429212 ]]

 [[-0.74606377  0.6106348  -0.26554468]
  [-0.55859023 -0.35687232  0.748745  ]
  [ 0.36244422  0.7069422   0.60734415]]

 [[-0.16853626  0.61572605 -0.7697252 ]
  [ 0.9855458   0.11886837 -0.12070522]
  [ 0.01717462 -0.7789427  -0.6268599 ]]

 [[ 0.7561905  -0.3324926  -0.563582  ]
  [ 0.5429612   0.7995174   0.2568366 ]
  [ 0.36519736 -0.50022054  0.785118  ]]

 [[ 0.77301854 -0.58071446 -0.25536844]
  [ 0.25237784 -0.08780504  0.9636367 ]
  [-0.5820204  -0.8093584   0.07868452]]

 [[-0.28316513 -0.7468035  -0.60174906]
  [ 0.8560133   0.08614557 -0.50972563]
  [ 0.43250293 -0.6594417   0.6148803 ]]

 [[-0.14112382  0.9097205   0.3905032 ]
  [-0.8198383  -0.32849845  0.46899253]
  [ 0.5549318  -0.25396344  0.7921826 ]]

 [[-0.456592   -0.85562974 -0.2437653 ]
  [-0.4374926  -0.02264298  0.89893687]
  [-0.7746767   0.5170929  -0.36399308]]

 [[-0.90090746  0.11707234 -0.4179232 ]
  [-0.10193092  0.8789243   0.4659422 ]
  [ 0.4218718   0.4623701  -0.7798962 ]]

 [[-0.3212181  -0.4951543  -0.80724293]
  [-0.94361854  0.2393791   0.22865206]
  [ 0.08001903  0.8351765  -0.54412967]]

 [[ 0.97377276  0.06877313  0.21687976]
  [ 0.22443578 -0.13386007 -0.96525127]
  [-0.03735181  0.98861104 -0.14578445]]

 [[ 0.3553472  -0.9034085   0.23996124]
  [ 0.5433438   0.4085248   0.7334064 ]
  [-0.76059574 -0.13023247  0.63602954]]

 [[ 0.61806667  0.37725997 -0.68968725]
  [-0.56937826  0.8197458  -0.061849  ]
  [ 0.54203504  0.4309197   0.7214612 ]]

 [[ 0.29776487  0.94447404 -0.13894196]
  [ 0.9458294  -0.31160292 -0.09116109]
  [-0.129394   -0.10427082 -0.9860957 ]]

 [[ 0.19716635  0.21056636  0.9574901 ]
  [-0.7070152  -0.64604855  0.2876643 ]
  [ 0.6791575  -0.7336778   0.0214946 ]]

 [[-0.5650244   0.29759222 -0.76953644]
  [ 0.77823645 -0.1175508  -0.616871  ]
  [-0.27403563 -0.94742846 -0.16517805]]

 [[ 0.28065488  0.8733582   0.39809337]
  [ 0.47991553 -0.48688373  0.72981185]
  [ 0.83121234 -0.01377406 -0.55578446]]

 [[ 0.8024307   0.0278064   0.5960972 ]
  [-0.15877286 -0.9529598   0.25818375]
  [ 0.5752358  -0.3018186  -0.7602692 ]]

 [[ 0.32265848 -0.30083787  0.8974342 ]
  [-0.05781392 -0.9526389  -0.29855752]
  [ 0.94474816  0.04444793 -0.32476965]]

 [[ 0.4935579  -0.7422682   0.4532532 ]
  [ 0.85551316  0.5081454  -0.09942588]
  [-0.15651786  0.4368365   0.8858194 ]]

 [[-0.8976416  -0.28571573  0.33556825]
  [-0.4102273   0.26334086 -0.87313527]
  [ 0.16109966 -0.92142177 -0.35359412]]

 [[-0.9217232   0.19335265 -0.3362159 ]
  [-0.33698434  0.02991741  0.9410348 ]
  [ 0.19201028  0.9806731   0.03758125]]

 [[ 0.24043693 -0.61969984  0.74710256]
  [ 0.35552713  0.7724179   0.5262804 ]
  [-0.90321124  0.13907798  0.40603787]]

 [[-0.7921809  -0.47242945 -0.3863416 ]
  [ 0.16552024  0.44300157 -0.88110876]
  [ 0.58741164 -0.7619449  -0.27274075]]

 [[-0.71742296  0.624828   -0.30804914]
  [-0.68107444 -0.7220424   0.12162399]
  [-0.14643046  0.29706025  0.9435642 ]]

 [[ 0.87354153 -0.40243074  0.27381516]
  [ 0.33415928  0.9048438   0.26380917]
  [-0.35392484 -0.13895038  0.9248946 ]]

 [[ 0.48421115  0.11260304 -0.8676751 ]
  [ 0.27090228 -0.96224743  0.02630238]
  [-0.83195645 -0.24779108 -0.49643534]]

 [[ 0.10466753 -0.18718329  0.9767329 ]
  [-0.49893624  0.83970237  0.21438888]
  [-0.86029494 -0.509767   -0.00550296]]

 [[ 0.62265253 -0.1254365   0.7723791 ]
  [ 0.46602726 -0.7334752  -0.49480575]
  [ 0.6285876   0.66804177 -0.39824337]]

 [[-0.07320144 -0.99607444 -0.04977208]
  [-0.4329861  -0.01321643  0.9013037 ]
  [-0.8984234   0.08752735 -0.43031895]]

 [[ 0.06439313  0.97830254 -0.19692042]
  [ 0.938444   -0.12647276 -0.32144597]
  [-0.33937648 -0.16409987 -0.92622614]]

 [[-0.32914323  0.8692355  -0.36890975]
  [-0.34743685  0.2517924   0.9032653 ]
  [ 0.87803894  0.4254765   0.21912868]]

 [[-0.03135483  0.12190171 -0.9920468 ]
  [ 0.20567426 -0.9705069  -0.12575549]
  [-0.97811806 -0.20798153  0.00535803]]

 [[ 0.7707965   0.47634456 -0.42304692]
  [ 0.46966657 -0.8735372  -0.1278519 ]
  [-0.43044877 -0.10014319 -0.89704245]]

 [[ 0.62561727 -0.6937239   0.3568615 ]
  [-0.5623879  -0.08402125  0.8225936 ]
  [-0.54066896 -0.7153234  -0.44270706]]

 [[-0.03840629 -0.82296616  0.5667907 ]
  [ 0.98650855 -0.12155963 -0.10965481]
  [ 0.15914106  0.5549324   0.8165318 ]]

 [[ 0.71410507 -0.68704677  0.13424103]
  [-0.2821377  -0.45796388 -0.8430109 ]
  [ 0.6406655   0.5641239  -0.52087617]]

 [[-0.69007146 -0.31053713  0.65373397]
  [-0.5909326   0.76325965 -0.26121518]
  [-0.41785175 -0.56656986 -0.7102102 ]]

 [[ 0.56709814 -0.23533636  0.7893139 ]
  [ 0.71543354 -0.3340903  -0.6136274 ]
  [ 0.40811095  0.9126886  -0.02109447]]

 [[ 0.12042128  0.97353137 -0.1942559 ]
  [-0.98601013  0.09457714 -0.13725595]
  [-0.1152508   0.20806684  0.9713009 ]]

 [[ 0.2616124  -0.60064805  0.75550044]
  [-0.53597796 -0.7413841  -0.40382826]
  [ 0.80267465 -0.29928508 -0.51588935]]

 [[ 0.4752947  -0.37172344  0.7974438 ]
  [-0.16437629  0.852889    0.4955409 ]
  [-0.86433524 -0.36660883  0.3442711 ]]

 [[ 0.83131063  0.4779445   0.28371063]
  [-0.47808513  0.35454983  0.80357265]
  [ 0.28347358 -0.80365634  0.5232392 ]]

 [[ 0.5751311   0.03900152  0.817131  ]
  [-0.2759492  -0.93106997  0.23866446]
  [ 0.7701144  -0.36275    -0.5247249 ]]

 [[-0.6807762  -0.6099538  -0.4055862 ]
  [ 0.07149926 -0.6063983   0.79194   ]
  [-0.7289936   0.51013476  0.45643273]]

 [[ 0.2740054   0.6167242  -0.73795146]
  [ 0.6337515   0.4613638   0.6208885 ]
  [ 0.723381   -0.6378046  -0.2644337 ]]

 [[ 0.02657237 -0.9912923  -0.12897094]
  [ 0.27007505 -0.11709963  0.955692  ]
  [-0.96247256 -0.06022683  0.2646117 ]]

 [[ 0.75919664  0.46289822  0.45754305]
  [ 0.21626565  0.48362747 -0.8481354 ]
  [-0.61388075  0.7428524   0.2670594 ]]

 [[ 0.13419732  0.7730551  -0.6199814 ]
  [ 0.01575056  0.62389755  0.7813474 ]
  [ 0.99082947 -0.11461978  0.07154934]]

 [[ 0.79693866 -0.5938283  -0.11070973]
  [-0.44239753 -0.6985636   0.5623996 ]
  [-0.41130662 -0.39922032 -0.8194205 ]]

 [[-0.22713113 -0.6608967  -0.71528107]
  [ 0.9729143  -0.12155604 -0.19662638]
  [ 0.04300299 -0.74056715  0.670605  ]]

 [[ 0.8058346   0.03859074  0.5908818 ]
  [-0.50750047 -0.46910948  0.7227583 ]
  [ 0.30508006 -0.88229644 -0.35843983]]

 [[-0.8454198  -0.47147912  0.2509438 ]
  [-0.4824494   0.47254413 -0.737526  ]
  [ 0.22914608 -0.74458677 -0.62696296]]

 [[ 0.17157505  0.919783    0.35293233]
  [ 0.95262057 -0.24622187  0.17857464]
  [ 0.25114956  0.30557165 -0.9184497 ]]

 [[ 0.03022775 -0.19667654  0.98000234]
  [ 0.96350527 -0.25516328 -0.08092759]
  [ 0.26597717  0.9466837   0.18178587]]

 [[-0.9041375   0.40690884  0.13023265]
  [-0.25787845 -0.27672303 -0.9257014 ]
  [-0.3406377  -0.87054557  0.3551287 ]]

 [[ 0.7687602  -0.6344005   0.0808938 ]
  [-0.632561   -0.7356356   0.24229503]
  [-0.09420372 -0.23743704 -0.96682435]]

 [[ 0.04193974 -0.00535576  0.9991058 ]
  [-0.7404277   0.6712408   0.03467936]
  [-0.6708263  -0.74122     0.02418612]]

 [[-0.6622805   0.6703489   0.3346893 ]
  [ 0.22140734  0.6018422  -0.7673101 ]
  [-0.7157956  -0.43407184 -0.5470085 ]]

 [[ 0.00894117 -0.96657425 -0.25623092]
  [ 0.29809982  0.24716662 -0.92197895]
  [ 0.9544928  -0.06813882  0.29034555]]

 [[-0.09509467 -0.9904526  -0.0998034 ]
  [-0.64432764  0.13766427 -0.75225693]
  [ 0.75881416 -0.00722953 -0.6512671 ]]

 [[-0.9305973   0.3447069   0.12314964]
  [-0.24025165 -0.32136247 -0.91597235]
  [-0.2761663  -0.8819883   0.38187546]]

 [[ 0.48192862  0.10002189  0.87048286]
  [-0.66315746 -0.6076826   0.43697143]
  [ 0.572684   -0.7878563  -0.22652936]]

 [[ 0.90507764 -0.2945374  -0.30672824]
  [ 0.39986137  0.8349404   0.37813416]
  [ 0.14472514 -0.46488956  0.87346   ]]

 [[ 0.48447585 -0.7077471   0.51417625]
  [-0.8526892  -0.2507242   0.4583214 ]
  [-0.1954592  -0.6604782  -0.7249581 ]]

 [[-0.64288104  0.45185107  0.6184938 ]
  [-0.23015156  0.6562045  -0.71862775]
  [-0.73057115 -0.6043395  -0.31786725]]

 [[ 0.3051706  -0.8374807  -0.45331776]
  [-0.89213204 -0.08490215 -0.44372526]
  [ 0.33312368  0.53983116 -0.773053  ]]

 [[-0.32206497  0.9112062  -0.25686076]
  [-0.869473   -0.17734958  0.46104652]
  [ 0.37455428  0.37182042  0.8493872 ]]

 [[ 0.36106732 -0.7101037   0.6044693 ]
  [ 0.7567135   0.60192007  0.2551017 ]
  [-0.5449909   0.36530122  0.7546787 ]]

 [[ 0.2784756   0.9030173  -0.3271255 ]
  [ 0.5723424   0.11749122  0.811554  ]
  [ 0.7712817  -0.4132258  -0.48411667]]

 [[-0.3412885  -0.83527166 -0.43109557]
  [ 0.17580529 -0.50726277  0.84366876]
  [-0.9233714   0.21214558  0.3199681 ]]

 [[ 0.29190388 -0.9513335  -0.09877581]
  [ 0.58719295  0.25977066 -0.76663136]
  [ 0.75498116  0.16578221  0.63444436]]

 [[-0.13226686 -0.7524733  -0.64520496]
  [ 0.25284782  0.6037764  -0.75599074]
  [ 0.95842236 -0.2631312   0.11040162]]

 [[ 0.62349445 -0.19195779  0.75789636]
  [ 0.7480926  -0.13520728 -0.6496741 ]
  [ 0.2271831   0.9720449   0.05930121]]

 [[-0.3340281   0.42084858 -0.84339297]
  [ 0.60749245  0.7802727   0.14875284]
  [ 0.7206789  -0.46266723 -0.5162954 ]]

 [[-0.7137928  -0.55692726  0.424655  ]
  [-0.4062189   0.8231522   0.39674512]
  [-0.57051384  0.11069094 -0.8137945 ]]

 [[ 0.04948916  0.98905236 -0.13901877]
  [-0.8053667  -0.04280368 -0.59122956]
  [-0.5907075   0.14122054  0.7944315 ]]

 [[-0.8718017   0.4881776   0.04055191]
  [-0.41275287 -0.68747216 -0.597509  ]
  [-0.2638122  -0.5376473   0.8008361 ]]

 [[ 0.4465874  -0.0498378  -0.89335096]
  [-0.6495765   0.6685733  -0.36202222]
  [ 0.615313    0.74197435  0.26620296]]

 [[ 0.68048185  0.722134    0.1243663 ]
  [ 0.3168133  -0.13690114 -0.938556  ]
  [-0.6607373   0.67807126 -0.32194036]]

 [[-0.29298428  0.08057311 -0.95271623]
  [ 0.15083723  0.98785996  0.03715903]
  [ 0.94414425 -0.13281806 -0.30158085]]

 [[-0.19727239 -0.42594904 -0.8829785 ]
  [ 0.97395647 -0.1878395  -0.1269846 ]
  [-0.11176925 -0.8850332   0.4519114 ]]

 [[-0.58162045  0.6032319  -0.545737  ]
  [-0.80308783 -0.53260213  0.2671795 ]
  [-0.12948951  0.59367186  0.7942205 ]]

 [[-0.4366172   0.64718044  0.62491834]
  [-0.77699894 -0.62140095  0.10066504]
  [ 0.4534733  -0.44160882  0.77417284]]

 [[ 0.05435671 -0.76187783  0.64543587]
  [ 0.69972587  0.49019638  0.51970303]
  [-0.71234053  0.42337883  0.5597511 ]]]
</pre></div>
</div>
<p>Given any <code class="docutils literal notranslate"><span class="pre">Source</span></code>, we can also take slices using typical slicing
syntax, or provide our own iterable of indices.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">sim_evens</span> <span class="o">=</span> <span class="n">sim</span><span class="p">[</span><span class="mi">0</span><span class="p">::</span><span class="mi">2</span><span class="p">]</span>
<span class="n">sim_odds</span> <span class="o">=</span> <span class="n">sim</span><span class="p">[</span><span class="mi">1</span><span class="p">::</span><span class="mi">2</span><span class="p">]</span>

<span class="c1"># We can also generate random selections.</span>
<span class="c1"># Shuffle indices then take the first 5.</span>
<span class="n">shuffled_inds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">sim</span><span class="o">.</span><span class="n">n</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">sim_shuffled_subset</span> <span class="o">=</span> <span class="n">sim</span><span class="p">[</span><span class="n">shuffled_inds</span><span class="p">]</span>
</pre></div>
</div>
<p>Underneath those slices, ASPIRE relies on <code class="docutils literal notranslate"><span class="pre">IndexedSource</span></code>, which
we can also call direcly to remap indices.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">aspire.source</span><span class="w"> </span><span class="kn">import</span> <span class="n">IndexedSource</span>

<span class="n">sim_shuffled_subset</span> <span class="o">=</span> <span class="n">IndexedSource</span><span class="p">(</span><span class="n">sim</span><span class="p">,</span> <span class="n">shuffled_inds</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="the-noise-package">
<h2>The <code class="docutils literal notranslate"><span class="pre">noise</span></code> Package<a class="headerlink" href="#the-noise-package" title="Link to this heading">¶</a></h2>
<p>The <a class="reference external" href="https://computationalcryoem.github.io/ASPIRE-Python/aspire.noise.html">aspire.noise</a>
package contains several useful classes for generating and
estimating different types of noise.</p>
<section id="noiseadder">
<h3><code class="docutils literal notranslate"><span class="pre">NoiseAdder</span></code><a class="headerlink" href="#noiseadder" title="Link to this heading">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">NoiseAdder</span></code> subclasses are used to add common or customized noise
to <code class="docutils literal notranslate"><span class="pre">Simulation</span></code> image generation pipelines.</p>
<section id="whitenoiseadder">
<h4><code class="docutils literal notranslate"><span class="pre">WhiteNoiseAdder</span></code><a class="headerlink" href="#whitenoiseadder" title="Link to this heading">¶</a></h4>
<p><code class="docutils literal notranslate"><span class="pre">WhiteNoiseAdder</span></code> is the most common type of synthetic noise.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">aspire.noise</span><span class="w"> </span><span class="kn">import</span> <span class="n">WhiteNoiseAdder</span>
</pre></div>
</div>
<p>Get the sample variance, then create a NoiseAdder based on that variance.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">var</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">sim</span><span class="o">.</span><span class="n">images</span><span class="p">[:]</span><span class="o">.</span><span class="n">asnumpy</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Sample Variance: </span><span class="si">{</span><span class="n">var</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">target_noise_variance</span> <span class="o">=</span> <span class="mf">10.0</span> <span class="o">*</span> <span class="n">var</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Target Noise Variance: </span><span class="si">{</span><span class="n">target_noise_variance</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">white_noise_adder</span> <span class="o">=</span> <span class="n">WhiteNoiseAdder</span><span class="p">(</span><span class="n">target_noise_variance</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Sample Variance: 3.230210131732747e-05
Target Noise Variance: 0.0003230210277251899
</pre></div>
</div>
<p>We can customize Sources by adding stages to their generation
pipeline.  In this case of a Simulation source, we want to corrupt
the projection images with noise.  Internally the
<code class="docutils literal notranslate"><span class="pre">WhiteNoiseAdder</span></code> creates a <code class="docutils literal notranslate"><span class="pre">ScalarFilter</span></code> which is multiplied
(convolution) by a Gaussian random sample.  Similar to before, if
you require a different sample, this can be controlled via a
<code class="docutils literal notranslate"><span class="pre">seed</span></code>.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Creating the new simulation with this additional noise is easy:</span>
<span class="n">sim</span> <span class="o">=</span> <span class="n">Simulation</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">num_imgs</span><span class="p">,</span> <span class="n">vols</span><span class="o">=</span><span class="n">vol_ds</span><span class="p">,</span> <span class="n">noise_adder</span><span class="o">=</span><span class="n">white_noise_adder</span><span class="p">)</span>
<span class="c1"># These should be rather noisy now ...</span>
<span class="n">sim</span><span class="o">.</span><span class="n">images</span><span class="p">[:</span><span class="mi">10</span><span class="p">]</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_aspire_introduction_007.png" srcset="../_images/sphx_glr_aspire_introduction_007.png" alt="aspire introduction" class = "sphx-glr-single-img"/></section>
<section id="whitenoiseestimator">
<h4><code class="docutils literal notranslate"><span class="pre">WhiteNoiseEstimator</span></code><a class="headerlink" href="#whitenoiseestimator" title="Link to this heading">¶</a></h4>
<p>We can estimate the noise across an <code class="docutils literal notranslate"><span class="pre">ImageSource</span></code>, and
we’ve generated a simulation with known noise variance.
Lets see how the estimate compares.</p>
<p>In this case, we know the noise to be white, so we can proceed directly to
<a class="reference external" href="https://computationalcryoem.github.io/ASPIRE-Python/aspire.noise.html#aspire.noise.noise.WhiteNoiseEstimator">WhiteNoiseEstimator</a>.
The noise estimators consume from an <code class="docutils literal notranslate"><span class="pre">ImageSource</span></code>.</p>
<p>The white noise estimator should log a diagnostic variance value.
Internally, it also uses the estimation results to build a
<code class="docutils literal notranslate"><span class="pre">Filter</span></code> which can be used in more advanced denoising methods.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">aspire.noise</span><span class="w"> </span><span class="kn">import</span> <span class="n">WhiteNoiseEstimator</span>

<span class="n">noise_estimator</span> <span class="o">=</span> <span class="n">WhiteNoiseEstimator</span><span class="p">(</span><span class="n">sim</span><span class="p">)</span>
<span class="n">noise_estimator</span><span class="o">.</span><span class="n">estimate</span><span class="p">()</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>  0%|          | 0/1 [00:00&lt;?, ?it/s]
100%|██████████| 1/1 [00:00&lt;00:00,  3.66it/s]
100%|██████████| 1/1 [00:00&lt;00:00,  3.66it/s]

0.00031902700292080427
</pre></div>
</div>
</section>
</section>
<section id="a-custom-functionfilter">
<h3>A Custom <code class="docutils literal notranslate"><span class="pre">FunctionFilter</span></code><a class="headerlink" href="#a-custom-functionfilter" title="Link to this heading">¶</a></h3>
<p>We will now apply some more interesting noise, using a custom
function, and then apply a <code class="docutils literal notranslate"><span class="pre">whitening</span></code> process to our data.</p>
<p>Using <code class="docutils literal notranslate"><span class="pre">FunctionFilter</span></code> we can create our own custom functions to
apply in a pipeline.  Here we want to apply a custom noise function.
We will use a function of two variables for this example.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">aspire.noise</span><span class="w"> </span><span class="kn">import</span> <span class="n">CustomNoiseAdder</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">aspire.operators</span><span class="w"> </span><span class="kn">import</span> <span class="n">FunctionFilter</span>


<span class="k">def</span><span class="w"> </span><span class="nf">noise_function</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="k">return</span> <span class="mf">1e-7</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">x</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span> <span class="o">*</span> <span class="n">y</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="mf">0.3</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>


<span class="c1"># In Python, functions are first class objects.  We take advantage of</span>
<span class="c1"># that to pass this function around as a variable.  The function is</span>
<span class="c1"># evaluated later, internally, during pipeline execution.</span>
<span class="n">custom_noise</span> <span class="o">=</span> <span class="n">CustomNoiseAdder</span><span class="p">(</span><span class="n">noise_filter</span><span class="o">=</span><span class="n">FunctionFilter</span><span class="p">(</span><span class="n">noise_function</span><span class="p">))</span>

<span class="c1"># Create yet another Simulation source to tinker with.</span>
<span class="n">sim</span> <span class="o">=</span> <span class="n">Simulation</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">num_imgs</span><span class="p">,</span> <span class="n">vols</span><span class="o">=</span><span class="n">vol_ds</span><span class="p">,</span> <span class="n">noise_adder</span><span class="o">=</span><span class="n">custom_noise</span><span class="p">)</span>
<span class="n">sim</span><span class="o">.</span><span class="n">images</span><span class="p">[:</span><span class="mi">10</span><span class="p">]</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_aspire_introduction_008.png" srcset="../_images/sphx_glr_aspire_introduction_008.png" alt="aspire introduction" class = "sphx-glr-single-img"/></section>
<section id="noise-whitening">
<h3>Noise Whitening<a class="headerlink" href="#noise-whitening" title="Link to this heading">¶</a></h3>
<p>We will now combine a more advanced noise estimation technique with
an <code class="docutils literal notranslate"><span class="pre">ImageSource</span></code> preprocessing method <code class="docutils literal notranslate"><span class="pre">whiten</span></code>.</p>
<p>First an anisotropic noise estimate is performed.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">aspire.noise</span><span class="w"> </span><span class="kn">import</span> <span class="n">AnisotropicNoiseEstimator</span>

<span class="c1"># Estimate noise.</span>
<span class="n">aiso_noise_estimator</span> <span class="o">=</span> <span class="n">AnisotropicNoiseEstimator</span><span class="p">(</span><span class="n">sim</span><span class="p">)</span>
</pre></div>
</div>
<p>Applying the <code class="docutils literal notranslate"><span class="pre">Simulation.whiten()</span></code> method requires passing a
corresponding <code class="docutils literal notranslate"><span class="pre">NoiseEstimator</span></code> instance.  Then we can inspect some
of the whitened images.  While noise is still present, we can see a
dramatic change.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Whiten based on the estimated noise.</span>
<span class="n">sim</span> <span class="o">=</span> <span class="n">sim</span><span class="o">.</span><span class="n">whiten</span><span class="p">(</span><span class="n">aiso_noise_estimator</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>  0%|          | 0/1 [00:00&lt;?, ?it/s]
100%|██████████| 1/1 [00:00&lt;00:00,  3.80it/s]
100%|██████████| 1/1 [00:00&lt;00:00,  3.80it/s]
</pre></div>
</div>
<p>What do the whitened images look like?</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">sim</span><span class="o">.</span><span class="n">images</span><span class="p">[:</span><span class="mi">10</span><span class="p">]</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_aspire_introduction_009.png" srcset="../_images/sphx_glr_aspire_introduction_009.png" alt="aspire introduction" class = "sphx-glr-single-img"/></section>
</section>
<section id="common-image-corruptions">
<h2>Common Image Corruptions<a class="headerlink" href="#common-image-corruptions" title="Link to this heading">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">Simulation</span></code> provides several configurable types of common cryo-EM
image corruptions.  Users should be aware that amplitude and offset
corruption is enabled by default.</p>
<section id="amplitudes">
<h3>Amplitudes<a class="headerlink" href="#amplitudes" title="Link to this heading">¶</a></h3>
<p>Simulation automatically generates random amplitude variability.
To disable, set to <code class="docutils literal notranslate"><span class="pre">amplitudes=1</span></code>.</p>
</section>
<section id="offsets">
<h3>Offsets<a class="headerlink" href="#offsets" title="Link to this heading">¶</a></h3>
<p>Simulation automatically generates random offsets.
To disable, set to <code class="docutils literal notranslate"><span class="pre">offsets=0</span></code>.</p>
</section>
<section id="noise">
<h3>Noise<a class="headerlink" href="#noise" title="Link to this heading">¶</a></h3>
<p>By default, no noise corruption is configured.
To enable, see <code class="docutils literal notranslate"><span class="pre">NoiseAdder</span></code> components.</p>
</section>
<section id="ctf">
<h3>CTF<a class="headerlink" href="#ctf" title="Link to this heading">¶</a></h3>
<p>By default, no CTF corruption is configured.
To enable, we must configure one or more <code class="docutils literal notranslate"><span class="pre">CTFFilter</span></code> instances.
Usually we will create a range of filters for a variety of
defocus levels.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">aspire.operators</span><span class="w"> </span><span class="kn">import</span> <span class="n">RadialCTFFilter</span>

<span class="c1"># Radial CTF Filter params.</span>
<span class="n">defocus_min</span> <span class="o">=</span> <span class="mi">15000</span>  <span class="c1"># unit is angstroms</span>
<span class="n">defocus_max</span> <span class="o">=</span> <span class="mi">25000</span>
<span class="n">defocus_ct</span> <span class="o">=</span> <span class="mi">7</span>

<span class="c1"># Generate several CTFs.</span>
<span class="n">ctf_filters</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">RadialCTFFilter</span><span class="p">(</span><span class="n">defocus</span><span class="o">=</span><span class="n">d</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">defocus_min</span><span class="p">,</span> <span class="n">defocus_max</span><span class="p">,</span> <span class="n">defocus_ct</span><span class="p">)</span>
<span class="p">]</span>
</pre></div>
</div>
</section>
<section id="combining-into-a-simulation">
<h3>Combining into a Simulation<a class="headerlink" href="#combining-into-a-simulation" title="Link to this heading">¶</a></h3>
<p>Here we’ll combine the parameters above into a new simulation.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">sim</span> <span class="o">=</span> <span class="n">Simulation</span><span class="p">(</span>
    <span class="n">n</span><span class="o">=</span><span class="n">num_imgs</span><span class="p">,</span>
    <span class="n">vols</span><span class="o">=</span><span class="n">vol_ds</span><span class="p">,</span>
    <span class="n">amplitudes</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">offsets</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">noise_adder</span><span class="o">=</span><span class="n">white_noise_adder</span><span class="p">,</span>
    <span class="n">unique_filters</span><span class="o">=</span><span class="n">ctf_filters</span><span class="p">,</span>
    <span class="n">seed</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># Simulation has two unique accessors ``clean_images`` which disables</span>
<span class="c1"># noise, and ``projections`` which are clean uncorrupted projections.</span>
<span class="c1"># Both act like calls to `image` and return show-able ``Image``</span>
<span class="c1"># instances.</span>
</pre></div>
</div>
<p>Clean projections.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">sim</span><span class="o">.</span><span class="n">projections</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_aspire_introduction_010.png" srcset="../_images/sphx_glr_aspire_introduction_010.png" alt="aspire introduction" class = "sphx-glr-single-img"/><p>Images with only CTF applied.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">sim</span><span class="o">.</span><span class="n">clean_images</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_aspire_introduction_011.png" srcset="../_images/sphx_glr_aspire_introduction_011.png" alt="aspire introduction" class = "sphx-glr-single-img"/><p>And now the first four corrupted images.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">sim</span><span class="o">.</span><span class="n">images</span><span class="p">[:</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_aspire_introduction_012.png" srcset="../_images/sphx_glr_aspire_introduction_012.png" alt="aspire introduction" class = "sphx-glr-single-img"/><div class="admonition note">
<p class="admonition-title">Note</p>
<p>Above the <code class="docutils literal notranslate"><span class="pre">show</span></code> call has been customized as a 2 column grid
with out colorbar legend.</p>
</div>
</section>
</section>
<section id="real-experimental-data-relionsource">
<h2>Real Experimental Data - <code class="docutils literal notranslate"><span class="pre">RelionSource</span></code><a class="headerlink" href="#real-experimental-data-relionsource" title="Link to this heading">¶</a></h2>
<p>Now that we have some basics, we can try to replace the simulation
with a real experimental data source.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">aspire.source</span><span class="w"> </span><span class="kn">import</span> <span class="n">RelionSource</span>

<span class="n">src</span> <span class="o">=</span> <span class="n">RelionSource</span><span class="p">(</span>
    <span class="s2">&quot;data/sample_relion_data.star&quot;</span><span class="p">,</span>
    <span class="n">data_folder</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="n">pixel_size</span><span class="o">=</span><span class="mf">5.0</span><span class="p">,</span>
    <span class="n">max_rows</span><span class="o">=</span><span class="mi">1024</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>/home/runner/work/ASPIRE-Python/ASPIRE-Python/src/aspire/source/image.py:257: UserWarning: User provided pixel_size: 5.0 angstrom, does not match pixel_size found in metadata: 1.3380000265598893 angstrom.
  check_pixel_size(_pixel_size, pixel_size)
</pre></div>
</div>
<p>Add downsampling to the <code class="docutils literal notranslate"><span class="pre">src</span></code> pipeline.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">src</span> <span class="o">=</span> <span class="n">src</span><span class="o">.</span><span class="n">downsample</span><span class="p">(</span><span class="n">img_size</span><span class="p">)</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">RelionSource</span></code> will auto-populate <code class="docutils literal notranslate"><span class="pre">CTFFilter</span></code> instances from the
STAR file metadata when available. Having these filters allows us to
perform a phase flipping correction.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">src</span> <span class="o">=</span> <span class="n">src</span><span class="o">.</span><span class="n">phase_flip</span><span class="p">()</span>
</pre></div>
</div>
<p>Display the experimental data images.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">src</span><span class="o">.</span><span class="n">images</span><span class="p">[:</span><span class="mi">10</span><span class="p">]</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_aspire_introduction_013.png" srcset="../_images/sphx_glr_aspire_introduction_013.png" alt="aspire introduction" class = "sphx-glr-single-img"/></section>
<section id="pipeline-roadmap">
<h2>Pipeline Roadmap<a class="headerlink" href="#pipeline-roadmap" title="Link to this heading">¶</a></h2>
<p>Now that the primitives have been introduced we can explore
higher-level components.  The higher-level components are designed
to be modular and cacheable (to memory or disk) to support
experimentation with entire pipelines or focused algorithmic
development on specific components.  Most pipelines will follow a
flow of data and components moving mostly left to right in the table
below.  This table is not exhaustive, but represents some of the
most common components.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head" colspan="3"><p>Image Processing</p></th>
<th class="head" colspan="2"><p>Ab initio</p></th>
</tr>
<tr class="row-even"><th class="head"><p>Data</p></th>
<th class="head"><p>Preprocessing</p></th>
<th class="head"><p>Denoising</p></th>
<th class="head"><p>Orientation</p></th>
<th class="head"><p>3D Reconstruction</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>Simulation</p></td>
<td><p>NoiseEstimator</p></td>
<td><p>Class Averaging</p></td>
<td><p>CLSyncVoting</p></td>
<td><p>MeanVolumeEstimator</p></td>
</tr>
<tr class="row-even"><td><p>RelionSource</p></td>
<td><p>downsample</p></td>
<td><p>cov2d (CWF)</p></td>
<td><p>CLSymmetryC2</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>CoordinateSource</p></td>
<td><p>whiten</p></td>
<td></td>
<td><p>CLSymmetryC3C4</p></td>
<td></td>
</tr>
<tr class="row-even"><td></td>
<td><p>phase_flip</p></td>
<td></td>
<td><p>CLSymmetryCn</p></td>
<td></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>normalize_background</p></td>
<td></td>
<td><p>CommonlineSDP</p></td>
<td></td>
</tr>
<tr class="row-even"><td></td>
<td><p>CTFEstimator</p></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<p>We’re now ready to explore a small example end-to-end ab initio
pipeline using simulated data.
<a class="reference internal" href="pipeline_demo.html#sphx-glr-auto-tutorials-pipeline-demo-py"><span class="std std-ref">Ab-initio Pipeline Demonstration</span></a></p>
<p>Larger simulations and experiments based on EMPIAR data can be found
in <a class="reference internal" href="../auto_experiments/index.html#exp"><span class="std std-ref">Experiments</span></a>.</p>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> (0 minutes 31.024 seconds)</p>
<div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-auto-tutorials-aspire-introduction-py">
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../_downloads/b738125812b6a1a37ae52e678adc6fa4/aspire_introduction.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">aspire_introduction.ipynb</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../_downloads/cc578da6563a387d87874e740882ccbd/aspire_introduction.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">aspire_introduction.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-zip docutils container">
<p><a class="reference download internal" download="" href="../_downloads/3a63258b61475b4a4c1429fe6658a4cf/aspire_introduction.zip"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">zipped:</span> <span class="pre">aspire_introduction.zip</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="configuration.html" class="btn btn-neutral float-left" title="ASPIRE Configuration" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="pipeline_demo.html" class="btn btn-neutral float-right" title="Ab-initio Pipeline Demonstration" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Princeton University.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>